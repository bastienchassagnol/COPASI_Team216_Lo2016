[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Overview",
    "section": "",
    "text": "Back to top"
  },
  {
    "objectID": "files.html",
    "href": "files.html",
    "title": "Files",
    "section": "",
    "text": "Back to top"
  },
  {
    "objectID": "components.html",
    "href": "components.html",
    "title": "",
    "section": "",
    "text": "Code"
  },
  {
    "objectID": "components.html#original-paper",
    "href": "components.html#original-paper",
    "title": "",
    "section": "Original paper",
    "text": "Original paper\nFigure 1\n\n\n\nDownload PDF file.\n\n\nFigure 1"
  },
  {
    "objectID": "components.html#species",
    "href": "components.html#species",
    "title": "",
    "section": "Species",
    "text": "Species"
  },
  {
    "objectID": "codes/prcc.html",
    "href": "codes/prcc.html",
    "title": "prcc",
    "section": "",
    "text": "Back to top",
    "crumbs": [
      "PRCC"
    ]
  },
  {
    "objectID": "codes/patient_stratification.html",
    "href": "codes/patient_stratification.html",
    "title": "patient_stratification",
    "section": "",
    "text": "Back to top",
    "crumbs": [
      "Patient Stratification"
    ]
  },
  {
    "objectID": "codes/steady_state.html",
    "href": "codes/steady_state.html",
    "title": "Steady-state computations",
    "section": "",
    "text": "The list of packages required for reproducing the analyses on this script are listed below:\nCode\n# install and load R connector to COPASI software\n# remotes::install_github(\"jpahle/CoRC\")\nlibrary(CoRC)\nlibrary(testthat)\n\n# tidyverse packages\nlibrary(dplyr)\n\n# Table reporting\nlibrary(flextable)",
    "crumbs": [
      "Steady State"
    ]
  },
  {
    "objectID": "codes/steady_state.html#run-steady-state-analyses",
    "href": "codes/steady_state.html#run-steady-state-analyses",
    "title": "Steady-state computations",
    "section": "Run steady-state Analyses",
    "text": "Run steady-state Analyses\nThe call to CoRC::runSteadyState() function retrieves the steady-state of the ODE model (see Note 1 for the mathematical definition of steady states).\n1healthy_model &lt;- loadModel(\"../../models/team_2016_final_model_lo2016.cps\")\n2healthy_model_steady_state &lt;- runSteadyState(\n  model = healthy_model,\n  calculate_jacobian = TRUE,\n  perform_stability_analysis = TRUE,\n3  method = list(\"use_newton\"=TRUE, accept_negative_concentrations = FALSE)\n)\n\n1\n\nRun CoRC::loadModel() function to load the COPASI model in R1.\n\n2\n\nWe ue the CoRC::runSteadyState function to run the steady-states…\n\n3\n\n… and for this this, several algorithms can be chosen. We used in our framework the well-known root-finding Newton-Raphson algorithm.\n\n\n\n\n\n\n\n\nNote 1: Derive Steady-States Conditions of an ODE model\n\n\n\nComputing the steady-state conditions for an ordinary differential equation (ODE) means finding the system’s equilibrium points, where the variables (also named the species) remain constant over time. In other words, this means finding the concentrations for which all the derivatives cancel:\nGiven a system of \\(n=15\\) ODEs (number of varying species in the simulated model),\n\\[\n\\begin{cases}\n\\frac{dx_1}{dt} &= f_1(x_1, x_2, \\dots, x_{15}) \\\\\n\\frac{dx_2}{dt} &= f_2(x_1, x_2, \\dots, x_{15}) \\\\\n&\\vdots \\\\\n\\frac{dx_{15}}{dt} &= f_n(x_1, x_2, \\dots, x_{15})\n\\end{cases}\n\\]\nthe steady-state conditions are obtained by solving system Equation 1:\n\\[\n\\begin{cases}\nf_1(x_1^*, x_2^*, \\dots, x_{15}^*)& = 0 \\\\\nf_2(x_1^*, x_2^*, \\dots, x_{15}^*) &= 0 \\\\\n& \\vdots \\\\\nf_n(x_1^*, x_2^*, \\dots, x_{15}^*) &= 0.\n\\end{cases}\n\\tag{1}\\]\n\n\nTo ensure that the model converged, we assert in Listing 1 that the outcome of the stability analysis is found. Other outcomes include notFound and foundNegative (which is irrealistic in our setting, since concentrations of species can either be positive or null).\n\n\n\n\nListing 1: Check that the model converged with a testthat equal. If not, returns an error.\n\n\ntestthat::expect_equal(healthy_model_steady_state$result, \"found\")",
    "crumbs": [
      "Steady State"
    ]
  },
  {
    "objectID": "codes/steady_state.html#report-steady-state-analyses",
    "href": "codes/steady_state.html#report-steady-state-analyses",
    "title": "Steady-state computations",
    "section": "Report steady-state analyses",
    "text": "Report steady-state analyses\nIn Table 1, we report the concentrations of the 15 varying species included in the Lo et al. (2016) ODE model describing the dynamic relations among pools of immune cells (macrophages and T-cells) and the secreted cytokines, using the flextable package (Gohel and Skintzos 2024).\n\n\nCode\n## Format table for reporting.\nsteady_state_concentrations &lt;- healthy_model_steady_state$species |&gt; \n  select(name, concentration) |&gt; \n  mutate(name = factor(name, \n                          levels = c(\"M1\", \"M2\", \n                                     \"T1\", \"T2\",\n                                     \"T17\", \"Tr\",\n                                     \"Ig\", \"I2\", \"I4\", \"I21\", \"I6\",\n                                     \"Ia\", \"I10\", \"Ib\", \"I12\"),\n                          labels = c(\"M1 macrophage\", \"M2 macrophage\", \n                                     \"Th1 cell\", \"Th2 cell\",\n                                     \"Th17 cell\", \"Treg cell\", \n                                     \"IFN-g\", \"IL-2\", \"IL-4\", \"IL-21\", \"IL-6\", \n                                     \"TNF-a\", \"IL-10\", \"TFG-b\", \"IL-12\"),\n                       ordered = TRUE)) |&gt; \n  arrange(name)\n\n## Format steady-state analysis report for Table 4 ----\nsteady_state_labels &lt;- list(\n  name = \"Species\",\n  concentration = \"Value(g/cm^3)\")\n\nsteady_state_table &lt;- flextable(steady_state_concentrations) |&gt; \n  # format to scientific notation, allowing max 2 significant digits\n  colformat_double(j = \"concentration\", digits = 3) |&gt; \n  set_formatter(concentration = function(x) {\n    formatC(x, format = \"e\", digits = 2)\n  }) |&gt; \n  add_footer_row(values = \"doi:10.1371/journal.pone.0165782.t004\", \n                 colwidths = 2) |&gt; \n  compose(j = \"name\", \n          i = ~ name %in% c(\"IFN-g\", \"TNF-a\", \"TFG-b\"),\n          value = as_paragraph(as_equation(c(\"\\\\text{IFN}_{\\\\gamma}\",\n                                             \"\\\\text{TNF}_{\\\\alpha}\",\n                                             \"\\\\text{TGF}_{\\\\beta}\")))) |&gt; \n  set_header_labels(values = steady_state_labels) |&gt; \n  bold(part = \"header\") |&gt; \n  set_caption(\"Table 4: Steady-state concentrations of cytokines,\n              macrophages and T cells in a healthy individual.\") \n\nsteady_state_table\n\n\n\n\n\nSpeciesValue(g/cm^3)M1 macrophage1.17e-02M2 macrophage8.17e-03Th1 cell1.40e-01Th2 cell3.99e-03Th17 cell6.18e-03Treg cell2.98e-04\nIFNγ\\text{IFN}_{\\gamma}IFNγ​2.01e-07IL-21.07e-08IL-43.36e-09IL-217.77e-08IL-61.46e-06\nTNFα\\text{TNF}_{\\alpha}TNFα​2.72e-05IL-103.01e-08\nTGFβ\\text{TGF}_{\\beta}TGFβ​1.64e-13IL-123.64e-07doi:10.1371/journal.pone.0165782.t004\n\n\n\nTable 1: Steady-state concentrations of cytokines, macrophages and T cells in healthy individuals, see also Table 4 reported in (Lo et al. 2016, 10).",
    "crumbs": [
      "Steady State"
    ]
  },
  {
    "objectID": "codes/steady_state.html#footnotes",
    "href": "codes/steady_state.html#footnotes",
    "title": "Steady-state computations",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nNote that models are loaded by reference with the CoRC package, meaning that you modify the object in place. Note that his behaviour is rather uncommon in R, the default being the Copy-on-Modify Behavior (aka by value).↩︎",
    "crumbs": [
      "Steady State"
    ]
  },
  {
    "objectID": "curation.html",
    "href": "curation.html",
    "title": "Curation",
    "section": "",
    "text": "The list of packages required for reproducing the tutorials are listed in Table 1:\n\n\nFinding R package dependencies ... [25/42] \b\b\b\b\b\b\b\b[26/42] \b\b\b\b\b\b\b\b[27/42] \b\b\b\b\b\b\b\b[28/42] \b\b\b\b\b\b\b\b[29/42] \b\b\b\b\b\b\b\b[30/42] \b\b\b\b\b\b\b\b[31/42] \b\b\b\b\b\b\b\b[32/42] \b\b\b\b\b\b\b\b[33/42] \b\b\b\b\b\b\b\b[34/42] \b\b\b\b\b\b\b\b[35/42] \b\b\b\b\b\b\b\b[36/42] \b\b\b\b\b\b\b\b[37/42] \b\b\b\b\b\b\b\b[38/42] \b\b\b\b\b\b\b\b[39/42] \b\b\b\b\b\b\b\b[40/42] \b\b\b\b\b\b\b\b[41/42] \b\b\b\b\b\b\b\b[42/42] Done!\n\n\n\n\n\nPackageSourceCoRCsteady_statedplyrsteady_stateflextablesteady_statetestthatsteady_statedplyrcurationflextablecurationrenvcurationtoolscurationdplyrcurationflextablecurationrenvcurationtoolscuration\n\n\n\nTable 1: List of dependencies, per file.\n\n\n\n\n\n\n\n\n\n Back to top"
  },
  {
    "objectID": "history.html",
    "href": "history.html",
    "title": "Curation",
    "section": "",
    "text": "Back to top"
  }
]
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bastien CHASSAGNOL">
<meta name="author" content="Lilija Wehling">
<meta name="author" content="Atreyee Banerjee">
<meta name="author" content="Soria Gasparini">
<meta name="author" content="Sanjana Balaji Kuttae">

<title>Sensitivity analyses – ODE Model of Inflammatory Bowel Disease</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../reproducibility/patient_stratification.html" rel="next">
<link href="../reproducibility/steady_state.html" rel="prev">
<link href="../assets/img/IBD-disease.jpeg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-46f4cc9626f044588a66931b604fc9c8.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-32a38cf68e3b77bb2a3ceecec810c8ed.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-10c2e03f0e1829b468e237c5ac4b3503.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-32a38cf68e3b77bb2a3ceecec810c8ed.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<link href="../site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="../site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Sensitivity analyses – ODE Model of Inflammatory Bowel Disease">
<meta property="og:description" content="This GitHub repository stores the R code and COPASI models for reproducing Lo2016’s model on Inflammatory Bowel Disease.">
<meta property="og:image" content="https://bastienchassagnol.github.io/Lo2016_ODE_IBD/assets/img/Randomly-sampled-variables-vs-Latin-hypercube-samples.png">
<meta property="og:site_name" content="ODE Model of Inflammatory Bowel Disease">
<meta property="og:image:height" content="467">
<meta property="og:image:width" content="824">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../assets/img/IBD-disease.jpeg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ODE Model of Inflammatory Bowel Disease</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../files.html"> 
<span class="menu-text">Files</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../GTBioSS_slides.html"> 
<span class="menu-text">GT BioSS slides</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-curation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Curation</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-curation">    
        <li>
    <a class="dropdown-item" href="../reproducibility/steady_state.html">
 <span class="dropdown-text">Steady State</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reproducibility/prcc.html">
 <span class="dropdown-text">PRCC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../reproducibility/patient_stratification.html">
 <span class="dropdown-text">Patient Stratification</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://bastienchassagnol.github.io/bastien.chassagnol.io/"> <i class="bi bi-folder-symlink" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/posts/bastien-chassagnol-677b67140_identifiersorg-activity-7250082014123425793-jItc"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:bastien_chassagnol@laposte.net"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/bastienchassagnol/COPASI_Team216_Lo2016">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/bastienchassagnol/COPASI_Team216_Lo2016/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../reproducibility/prcc.html">PRCC</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
  <div id="quarto-announcement" data-announcement-id="2449c185770fef7e9639b4d1485f586c" class="alert alert-warning hidden"><i class="bi bi-cone-striped quarto-announcement-icon"></i><div class="quarto-announcement-content">
<p>Website under active development</p>
</div><i class="bi bi-x-lg quarto-announcement-action"></i></div>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Sensitivity analyses</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-heading">Affiliations</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author">Bastien CHASSAGNOL <a href="mailto:bastien_chassagnol@laposte.net" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Sorbonne University
            </p>
          <p class="affiliation">
              University Laval
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Lilija Wehling <a href="mailto:Wehling@bmedx.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Virtual Patient Engine BioMed X Institute
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Atreyee Banerjee <a href="mailto:banerjeea@mpip-mainz.mpg.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Mainz Universität
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Soria Gasparini <a href="mailto:soria.gasparini@stud.uni-heidelberg.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Heidelberg University
            </p>
        </div>
      <div class="quarto-title-meta-contents">
      <p class="author">Sanjana Balaji Kuttae <a href="mailto:balaji-kuttae@bmedx.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              Virtual Patient Engine BioMed X Institute
            </p>
        </div>
    </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Friday, the 16th of May, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reproducibility/steady_state.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Steady State</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reproducibility/prcc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">PRCC</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../reproducibility/patient_stratification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Patient Stratification</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#evaluate-the-sensitivity-of-immune-cells-to-parameter-constants" id="toc-evaluate-the-sensitivity-of-immune-cells-to-parameter-constants" class="nav-link active" data-scroll-target="#evaluate-the-sensitivity-of-immune-cells-to-parameter-constants"><span class="header-section-number">1</span> Evaluate the sensitivity of immune cells to parameter constants</a>
  <ul>
  <li><a href="#generate-the-distributions-of-nine-critical-parameters" id="toc-generate-the-distributions-of-nine-critical-parameters" class="nav-link" data-scroll-target="#generate-the-distributions-of-nine-critical-parameters"><span class="header-section-number">1.1</span> Generate the distributions of nine critical parameters</a></li>
  <li><a href="#compute-steady-states-for-the-5000-simulated-parameter-variations" id="toc-compute-steady-states-for-the-5000-simulated-parameter-variations" class="nav-link" data-scroll-target="#compute-steady-states-for-the-5000-simulated-parameter-variations"><span class="header-section-number">1.2</span> Compute steady states for the 5000 simulated parameter variations</a></li>
  <li><a href="#compute-partial-correlation-scores" id="toc-compute-partial-correlation-scores" class="nav-link" data-scroll-target="#compute-partial-correlation-scores"><span class="header-section-number">1.3</span> Compute partial correlation scores</a></li>
  <li><a href="#plot-rank-transformed-datasets" id="toc-plot-rank-transformed-datasets" class="nav-link" data-scroll-target="#plot-rank-transformed-datasets"><span class="header-section-number">1.4</span> Plot rank-transformed datasets</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/edit/master/reproducibility/prcc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/blob/master/reproducibility/prcc.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">






<p>The list of packages required for reproducing the analyses on this script are listed in <a href="#lst-setup-sensitivity-analyses" class="quarto-xref">Listing&nbsp;1</a>:</p>
<div class="cell" data-layout-align="center">
<div id="lst-setup-sensitivity-analyses" class="r cell-code listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-setup-sensitivity-analyses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;1: Packages required for computing sensitivity analyses.
</figcaption>
<div aria-describedby="lst-setup-sensitivity-analyses-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("jpahle/CoRC")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CoRC)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># to generate the simulations </span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lhs) <span class="co"># Latin Hypercube sampling</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel) <span class="co"># parallel computing</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor) <span class="co"># Compute partial correlations</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Table reporting</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</figure>
</div>
</div>
<section id="evaluate-the-sensitivity-of-immune-cells-to-parameter-constants" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="evaluate-the-sensitivity-of-immune-cells-to-parameter-constants"><span class="header-section-number">1</span> Evaluate the sensitivity of immune cells to parameter constants</h2>
<section id="generate-the-distributions-of-nine-critical-parameters" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="generate-the-distributions-of-nine-critical-parameters"><span class="header-section-number">1.1</span> Generate the distributions of nine critical parameters</h3>
<p>We begin to extract the original constants of the 9 parameters assumed to have the strongest impact on the populations of T cell subsets, using <code>CoRC::getParameters</code>, reported in <a href="#tbl-healthy-parameters" class="quarto-xref">Table&nbsp;1</a>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Retrieve parameters we want to evaluate the versatility ----</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>healthy_model <span class="ot">&lt;-</span> <span class="fu">loadModel</span>(<span class="st">"../../models/team_2016_final_model_lo2016_2025_05_13.cps"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># S2 to be changed</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>parameters_healthy <span class="ot">&lt;-</span> <span class="fu">getParameters</span>(<span class="at">model =</span> healthy_model,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">key =</span> <span class="fu">c</span>(<span class="st">"(Diff of M0 to M1).delta_m_cit"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Diff of M1 to M2).sigma"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T1 from M).s12"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Proliferation of T1).s2"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T2).s4"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T17).s21"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T17).s6"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of Tr).sb"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of Tr).s10"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>mapping)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(parameters_healthy) <span class="sc">|&gt;</span> </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_row</span>(<span class="at">values =</span> <span class="st">"key is direct ID of the parameter in the model, reaction describes the biological mechanism associated with the value of the parameter, and value returns the constant value assumed for healthy individuals."</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-healthy-parameters" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-healthy-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-249ee48e{}.cl-2490df56{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2490df74{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2496c29a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2496c2ae{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-2496f77e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f788{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f792{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f79c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f79d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f7a6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2496f7a7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-249ee48e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-2496f77e"><p class="cl-2496c29a"><span class="cl-2490df56">key</span></p></th><th class="cl-2496f77e"><p class="cl-2496c29a"><span class="cl-2490df56">name</span></p></th><th class="cl-2496f77e"><p class="cl-2496c29a"><span class="cl-2490df56">reaction</span></p></th><th class="cl-2496f788"><p class="cl-2496c2ae"><span class="cl-2490df56">value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Diff of M0 to M1).delta_m_cit</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">delta_m_cit</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Diff of M0 to M1</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">2.40</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Diff of M1 to M2).sigma</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">sigma</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Diff of M1 to M2</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">24.00</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of T1 from M).s12</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">s12</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of T1 from M</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">10.93</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Proliferation of T1).s2</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">s2</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Proliferation of T1</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">1.23</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of T2).s4</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">s4</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of T2</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">1.94</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of T17).s21</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">s21</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of T17</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">156.17</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of T17).s6</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">s6</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of T17</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">156.17</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of Tr).sb</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">sb</span></p></td><td class="cl-2496f792"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of Tr</span></p></td><td class="cl-2496f79c"><p class="cl-2496c2ae"><span class="cl-2490df74">14.02</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-2496f79d"><p class="cl-2496c29a"><span class="cl-2490df74">(Induction of Tr).s10</span></p></td><td class="cl-2496f79d"><p class="cl-2496c29a"><span class="cl-2490df74">s10</span></p></td><td class="cl-2496f79d"><p class="cl-2496c29a"><span class="cl-2490df74">Induction of Tr</span></p></td><td class="cl-2496f7a6"><p class="cl-2496c2ae"><span class="cl-2490df74">14.02</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-2496f7a7"><p class="cl-2496c29a"><span class="cl-2490df74">key is direct ID of the parameter in the model, reaction describes the biological mechanism associated with the value of the parameter, and value returns the constant value assumed for healthy individuals.</span></p></td></tr></tfoot></table></div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-healthy-parameters-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: The 9 reaction parameters evaluated for <strong>sensitivity analyses</strong>.
</figcaption>
</figure>
</div>
</div>
<p>In <span class="citation" data-cites="lo2016po">Lo et al. (<a href="#ref-lo2016po" role="doc-biblioref">2016</a>)</span>, they chose to perform <strong>Latin Hypercube Sampling (LHS)</strong> against <strong>Standard Random Sampling</strong>. The differences between these two randomisation approaches are further detailled in <a href="#tip-LHS" class="quarto-xref">Tip&nbsp;1</a>, but briefly, the major advantage of LHS lies in its better coverage of the whole parameter sampling space, especially with a low number of observations (which is usually the case in boostrap simulations due to their high computing cost).</p>
<div id="tip-LHS" class="callout callout-style-default callout-tip callout-titled" title="Standard versus Latin Hypercube Sampling (LHS)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: Standard versus Latin Hypercube Sampling (LHS)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Random sampling and Latin Hypercube Sampling differ in how they distribute the sample points within the parameter space:</p>
<hr>
<p>In <strong>Standard Random Sampling</strong>, for a <span class="math inline">\(d-\)</span> random vector, the random samples are drawn independently within each dimension (or variable):</p>
<p><span class="math display">\[
x_i^{(j)} \sim p_j(x), \quad j = 1, 2, \dots, d, \quad i = 1, 2, \dots, N
\]</span></p>
<p>where <span class="math inline">\(x_i^{(j)}\)</span> is the <span class="math inline">\(i\)</span>-th sample drawn for the <span class="math inline">\(j\)</span>-th dimension, <span class="math inline">\(d=9\)</span> (number of parameters evaluated for sensitivity), <span class="math inline">\(N=5000\)</span> the total number of parameter distributions simulated, and <span class="math inline">\(p_j\)</span> the probability distribution<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Since each sample is drawn completely at random, it’s quite likely that some regions might be over-sampled while others may have gaps, with a low number of observations drawn (good coverage of the whole sampling space is only guaranteed asymptotically).</p>
<hr>
<p>In <strong>Latin Hypercube Sampling (LHS)</strong>, the sampling space is first stratified into <span class="math inline">\(N\)</span> equally probable intervals for each variable <span class="math inline">\(x^{(j)}\)</span>; an independent permutation is subsequently applied across dimensions to avoid correlation. Finally, each sample is drawn from of the <span class="math inline">\(N-\)</span> defined intervals. LHS then guarantees a more evenly distributed coverage.</p>
<hr>
<p>To conclude, LHS provides a <strong>better Coverage of the Input Space</strong>(notably reduces the probability of clustering or missing critical regions), <strong>Improved Convergence and Efficiency</strong> by achieving a more accurate representation of the underlying distribution and leading to lower variance in estimated statistics with fewer number of avalaible observations (see <a href="#fig-LHS" class="quarto-xref">Figure&nbsp;1</a> for further illustration). Yet, only standard random sampling is completely independent and unbiased.</p>
<div id="fig-LHS" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-LHS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../assets/img/Randomly-sampled-variables-vs-Latin-hypercube-samples.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-LHS-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Randomly sampled variables vs.&nbsp;Latin hypercube samples, from <a href="https://www.researchgate.net/figure/Randomly-sampled-variables-vs-Latin-hypercube-samples_fig3_322386503"><span class="citation" data-cites="rustell">Rustell (<span>n.d.</span>)</span></a>. With a low number of observations, the <strong>clustering pattern</strong> inherent to standard random sampling is clearly showcased.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The code snippet below generates the <span class="math inline">\(N=5000\)</span> bootstrap distribution of the 9 evaluated parameters for robustness, using <strong>Latin Hypercube Sampling</strong>. LHS indeed guarantees better coverage of the <em>sampling space</em>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower and upper bounds are computed within a ±20% range centered around the assumed parameter constant.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>parameters_sensitivity <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>value</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>param_ranges <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">parameters_name =</span> parameters_healthy<span class="sc">$</span>key, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">LB=</span> parameters_sensitivity <span class="sc">*</span><span class="fl">0.8</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">UB =</span> parameters_sensitivity <span class="sc">*</span><span class="fl">1.2</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>bootstrap_parameters <span class="ot">&lt;-</span> <span class="fu">randomLHS</span>(n_samples, <span class="fu">length</span>(parameters_sensitivity))</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(parameters_sensitivity)) {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  bootstrap_parameters[,i] <span class="ot">&lt;-</span> <span class="fu">qunif</span>(bootstrap_parameters[,i], </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>LB[i],</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>UB[i])</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootstrap_parameters) <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>name</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootstrap_parameters,<span class="dv">2</span>, quantile)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="do">##       delta_m_cit    sigma       s12        s2       s4      s21       s6</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  0%      1.920171 19.20104  8.744071 0.9840326 1.552041 124.9461 124.9454</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  25%     2.160095 21.59964  9.837180 1.1070501 1.745990 140.5559 140.5551</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  50%     2.399952 24.00043 10.930092 1.2299544 1.939971 156.1739 156.1738</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  75%     2.639956 26.39955 12.022974 1.3529785 2.133962 171.7861 171.7831</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  100%    2.879926 28.79855 13.115638 1.4759205 2.327949 187.3917 187.4018</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="do">##             sb      s10</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  0%   11.21699 11.21689</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  25%  12.61806 12.61786</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  50%  14.01999 14.01992</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  75%  15.42221 15.42153</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  100% 16.82292 16.82372</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="sourceCode" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-1" class="code-annotation-target"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>parameters_sensitivity <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>value</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>param_ranges <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">parameters_name =</span> parameters_healthy<span class="sc">$</span>key,</span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">LB=</span> parameters_sensitivity <span class="sc">*</span><span class="fl">0.8</span>,</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">UB =</span> parameters_sensitivity <span class="sc">*</span><span class="fl">1.2</span>)</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3">3</button><span id="annotated-cell-4-9" class="code-annotation-target"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4">4</button><span id="annotated-cell-4-10" class="code-annotation-target"><a href="#annotated-cell-4-10" aria-hidden="true" tabindex="-1"></a>bootstrap_parameters <span class="ot">&lt;-</span> <span class="fu">randomLHS</span>(n_samples, <span class="fu">length</span>(parameters_sensitivity))</span>
<span id="annotated-cell-4-11"><a href="#annotated-cell-4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-12"><a href="#annotated-cell-4-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5">5</button><span id="annotated-cell-4-13" class="code-annotation-target"><a href="#annotated-cell-4-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(parameters_sensitivity)) {</span>
<span id="annotated-cell-4-14"><a href="#annotated-cell-4-14" aria-hidden="true" tabindex="-1"></a>  bootstrap_parameters[,i] <span class="ot">&lt;-</span> <span class="fu">qunif</span>(bootstrap_parameters[,i],</span>
<span id="annotated-cell-4-15"><a href="#annotated-cell-4-15" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>LB[i],</span>
<span id="annotated-cell-4-16"><a href="#annotated-cell-4-16" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>UB[i])</span>
<span id="annotated-cell-4-17"><a href="#annotated-cell-4-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="annotated-cell-4-18"><a href="#annotated-cell-4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootstrap_parameters) <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="6">6</button><span id="annotated-cell-4-19" class="code-annotation-target"><a href="#annotated-cell-4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootstrap_parameters,<span class="dv">2</span>, quantile)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="1" data-code-annotation="1">Determine the number of observations, equivalently the number of generated bootstrap distributions (here, <span class="math inline">\(N=5000\)</span>).</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4,5,6" data-code-annotation="2">Lower and upper bounds are computed within a <span class="math inline">\(\pm 20\%\)</span> range, centered around the parameter constant.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="9" data-code-annotation="3">We fix the <strong>random seed</strong> to ensure reproducibibility of the sensitivity analyses.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="10" data-code-annotation="4">The core function of the <code>lhs</code> package, <code>lhs::randomLHS()</code>, is only able to perform standard uniform sampling. Two parameters must be provided: the number of observations to derive (here, 5000), and the dimension of the random vector (here, <span class="math inline">\(9\)</span> parameters are considered).</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="13,14,15,16,17" data-code-annotation="5">How to generate the uniform distribution for a given parameter <span class="math inline">\(X_j \sim \mathcal{U}(0.8 \times X_j^0, 1.2 \times  X_j^0)\)</span>, with <span class="math inline">\(X_j^0\)</span> the constant value estimated in a healthy individual, from the standard uniform distribution <span class="math inline">\(U \sim \mathcal{U}(0, 1)\)</span><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. By appling the <strong>Inverse Transform Sampling Theorem</strong> (see <a href="#tip-ITST" class="quarto-xref">Tip&nbsp;2</a>), which implies applying the reciprocal of the CDF, in other words, the <em>quantile function</em> which is given in R by the <code>stats::qunif</code> function. Alternatively, we could have reproduced this result by applying the following affine transformation: <code>bootstrap_parameters[,i] * (param_ranges$UB[i] -param_ranges$LB[i]) +  param_ranges$LB[i]</code> on the observations simulated wiht a standard uniform.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="19" data-code-annotation="6">By applying the <code>quantile</code> function, and since the distribution is supposed evenly distributed on the sampling space, we expect the quantiles to be rather close from their theoretical values (for example, both the median and the mean should be close to the real constant parameter values).</span>
</dd>
</dl>
<div id="tip-ITST" class="callout callout-style-default callout-tip callout-titled" title="The Inverse Transform Sampling Theorem">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;2: The Inverse Transform Sampling Theorem
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <strong>Inverse Transform Sampling Theorem</strong> allows generating any probability distribution from the <strong>standard uniform distribution</strong>, <span class="math inline">\(U \sim \mathcal{U}(0,1)\)</span>. Let <span class="math inline">\(X\)</span> be a continuous random variable with <em>cumulative distribution function</em> (CDF) <span class="math inline">\(F(x)\)</span> and <span class="math inline">\(F^{-1}\)</span> its reciprocal (the quantile function), then:</p>
<p><span class="math display">\[
X = F^{-1}(U)
\]</span></p>
<p>follows the same distribution as <span class="math inline">\(X\)</span>.</p>
<hr>
<p>In particular, for a uniform distribution <span class="math inline">\(X \sim \mathcal{U}(a, b)\)</span>, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> being respectively the lower and upper bounds, whose CDF is given by: <span class="math inline">\(F(x) = \frac{x - a}{b - a}, \quad a \leq x \leq b\)</span>, then the <em>quantile</em> function is given by <span class="math inline">\(F^{-1}(u) = a + u(b - a)\)</span>.</p>
<p>In other terms, if <span class="math inline">\(U\)</span> follows the standard uniform distirbution, then, by applying the <strong>affine</strong> transformation <span class="math inline">\(X=a + (b - a) U\)</span>, <span class="math inline">\(X\)</span> will follow the <span class="math inline">\(X \sim \mathcal{U}(a,b)\)</span> distribution.</p>
<p>Generally speaking, the <strong>Inverse Transform Sampling</strong> allows generating any probability distribution from a uniform <span class="math inline">\([0,1]\)</span> applying this formula: <span class="math inline">\(X = F^{-1}(U)\)</span>.</p>
</div>
</div>
</div>
<p><code>bootstrap_parameters</code> is a 5000 simulations times 9 parameters matrix storing all sampled parameter configurations. We displayed below only the first six lines of the simulated parameter distributions:</p>
<div class="cell" data-layout-align="center">
<pre><code>##       delta_m_cit    sigma       s12       s2       s4      s21       s6
##  [1,]    1.959796 23.44807  9.274411 1.439972 2.220298 136.2398 149.3445
##  [2,]    2.066597 19.27373  9.286449 1.204420 1.758831 127.5816 155.7143
##  [3,]    2.436843 19.47846 12.596935 1.279335 2.209452 129.4354 159.1146
##  [4,]    2.198476 22.11835 11.983510 1.453826 1.714273 144.2711 162.5585
##  [5,]    2.138463 25.98209  9.325547 1.168549 2.253209 158.9362 172.0287
##  [6,]    2.118051 22.26837  9.969860 1.435285 1.571099 126.8765 153.0293
##             sb      s10
##  [1,] 13.45400 15.11477
##  [2,] 16.35203 13.94127
##  [3,] 13.20491 14.63351
##  [4,] 12.43537 14.92586
##  [5,] 13.86563 15.75312
##  [6,] 13.35385 11.89732</code></pre>
</div>
</section>
<section id="compute-steady-states-for-the-5000-simulated-parameter-variations" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="compute-steady-states-for-the-5000-simulated-parameter-variations"><span class="header-section-number">1.2</span> Compute steady states for the 5000 simulated parameter variations</h3>
<p>We compute the corresponding steady-states for each of the <span class="math inline">\(N=5000\)</span> simulated parameter configurations. This task is computationally-intensive, but can be easily parallelised, since all bootstrap samples have been generated independently. We use to that end the standard <code>parallel</code> package.</p>
<div class="sourceCode" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-1" class="code-annotation-target"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>())</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-2" class="code-annotation-target"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="at">varlist =</span> <span class="fu">c</span>(<span class="st">"parameters_healthy"</span>, <span class="st">"bootstrap_parameters"</span>))</span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>cluster_environments <span class="ot">&lt;-</span> <span class="fu">clusterEvalQ</span>(cl, {</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(CoRC)</span>
<span id="annotated-cell-5-5"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>  healthy_model <span class="ot">&lt;-</span> <span class="fu">loadModel</span>(<span class="st">"./models/team_2016_final_model_lo2016.cps"</span>)</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>})</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3">3</button><span id="annotated-cell-5-8" class="code-annotation-target"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(<span class="at">cl =</span> cl,</span>
<span id="annotated-cell-5-9"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X =</span> <span class="dv">1</span><span class="sc">:</span>n_samples,</span>
<span id="annotated-cell-5-10"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">f =</span> <span class="cf">function</span> (i) {</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="5">5</button><span id="annotated-cell-5-11" class="code-annotation-target"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a>                      sensitivity_model <span class="ot">&lt;-</span> healthy_model <span class="sc">|&gt;</span> <span class="fu">saveModelToString</span>() <span class="sc">|&gt;</span>  <span class="fu">loadModelFromString</span>()</span>
<span id="annotated-cell-5-12"><a href="#annotated-cell-5-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">setParameters</span>(<span class="at">model =</span> sensitivity_model,</span>
<span id="annotated-cell-5-13"><a href="#annotated-cell-5-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">key =</span> parameters_healthy<span class="sc">$</span>key,</span>
<span id="annotated-cell-5-14"><a href="#annotated-cell-5-14" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">value =</span> bootstrap_parameters[i,])</span>
<span id="annotated-cell-5-15"><a href="#annotated-cell-5-15" aria-hidden="true" tabindex="-1"></a>                      sensitivity_model_steady_state <span class="ot">&lt;-</span> <span class="fu">runSteadyState</span>(</span>
<span id="annotated-cell-5-16"><a href="#annotated-cell-5-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model =</span> sensitivity_model</span>
<span id="annotated-cell-5-17"><a href="#annotated-cell-5-17" aria-hidden="true" tabindex="-1"></a>                      )<span class="sc">$</span>species</span>
<span id="annotated-cell-5-18"><a href="#annotated-cell-5-18" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="annotated-cell-5-19"><a href="#annotated-cell-5-19" aria-hidden="true" tabindex="-1"></a>                      SS_concentrations <span class="ot">&lt;-</span> <span class="fu">setNames</span>(sensitivity_model_steady_state<span class="sc">$</span>concentration,</span>
<span id="annotated-cell-5-20"><a href="#annotated-cell-5-20" aria-hidden="true" tabindex="-1"></a>                                                    sensitivity_model_steady_state<span class="sc">$</span>name) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-21"><a href="#annotated-cell-5-21" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.list</span>() <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-22"><a href="#annotated-cell-5-22" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(bootstrap_parameters[i, ,<span class="at">drop=</span><span class="cn">FALSE</span>] <span class="sc">|&gt;</span></span>
<span id="annotated-cell-5-23"><a href="#annotated-cell-5-23" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">as.data.frame</span>())</span>
<span id="annotated-cell-5-24"><a href="#annotated-cell-5-24" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(SS_concentrations)</span>
<span id="annotated-cell-5-25"><a href="#annotated-cell-5-25" aria-hidden="true" tabindex="-1"></a>                    }</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4">4</button><span id="annotated-cell-5-26" class="code-annotation-target"><a href="#annotated-cell-5-26" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">chunk.size =</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="6">6</button><span id="annotated-cell-5-27" class="code-annotation-target"><a href="#annotated-cell-5-27" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()</span>
<span id="annotated-cell-5-28"><a href="#annotated-cell-5-28" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="7">7</button><span id="annotated-cell-5-29" class="code-annotation-target"><a href="#annotated-cell-5-29" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="1" data-code-annotation="1">Use <code>detectCores()</code> to determine the number of available CPU cores; conditionned to that number (usually 8 or 16 on recent personal laptop configurations); use <code>makeCluster()</code> to create the corresponding cluster<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="2,3,4,5,6,7" data-code-annotation="2">Use <code>clusterExport()</code> to send current session variables to workers, and <code>clusterEvalQ()</code> to load required libraries and/or execute code prior to the parallelised computations. Both functions ensure that the cluster environement has the required modules to start the computation.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="8,9,10,12,13,14,15,16,17,19,20,21,22,23,24" data-code-annotation="3">The Parallel Processing <code>parLapply()</code> is the counterpart of the sequential <code>lapply()</code> function. The first argument <code>cl</code> is the cluster definition. For each parameter configuration among the <span class="math inline">\(N=5000\)</span>, we modifify the original ODE model to reflect the LHS parameter configuration, then, compute the modified steady-states associated with that change of parameter configuration. Finally, we return for each parameter configuration a dataset with the modified 15 steady-state concentrations and the corresponding 9 parameter configurations.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="26" data-code-annotation="4">The <code>chunk.size</code> option controls how data is divided among workers Once computed, another batch of 50 parameter configurations is processed).</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="11" data-code-annotation="5">This line is required, as <code>CoRC</code> uses copy by <em>reference</em> rather than by <em>value</em>. If we had just assigned the loaded healthy ODE model to the modified sensitivity model, <code>sensitivity_model &lt;- healthy_model</code>, every modification on <code>sensitivity_model</code> would also be reported on <code>healthy_model</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="27" data-code-annotation="6">The output of <code>parLapply</code> is a list of <code>data.frame</code>, function <code>dplyr::bind_rows()</code> concatenates them in a single large dataset.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="29" data-code-annotation="7">Stop the cluster using <code>stopCluster()</code> to free computational resources when no longer need.</span>
</dd>
</dl>
</section>
<section id="compute-partial-correlation-scores" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="compute-partial-correlation-scores"><span class="header-section-number">1.3</span> Compute partial correlation scores</h3>
<p>To compute the correlations between variations of the constant parameters, and the concentrations of the species at steady state, <span class="citation" data-cites="lo2016po">Lo et al. (<a href="#ref-lo2016po" role="doc-biblioref">2016</a>)</span> chose to apply a <em>rank-transformation</em> first, which guarantees increased robustness to outliers, and reduces <em>scaling issues</em> associated with significant variations of orders of magnitude between the parameters.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape and rank-transform sensitivity outputs</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"../../results/sensitivity_outputs.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), rank)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, instead on relying on standard Pearson correlation which may yield spurious relationships between outcomes and parameter variations, <span class="citation" data-cites="lo2016po">Lo et al. (<a href="#ref-lo2016po" role="doc-biblioref">2016</a>)</span> computes the <strong>Partial Correlation</strong> score between the rank-transformed variations of species of interest, and the simulated parameter distributions (see <a href="#imp-prcc" class="quarto-xref">Important&nbsp;1</a> for details).</p>
<p>The <code>pcor::ppcor</code> function returns both:</p>
<ul>
<li><code>estimate</code>, the symmetric matrix of the partial correlation coefficient between two variables (included between -1 and 1, the sign providing the type of correlation, and the absolute value the magnitude or strenght of the direct relationship)</li>
<li><code>p.value</code>, a matrix of the <span class="math inline">\(p-\)</span> values for each of the tests.</li>
<li>As in <span class="citation" data-cites="lo2016po">Lo et al. (<a href="#ref-lo2016po" role="doc-biblioref">2016</a>)</span>, the threshold for <em>significance</em> was set to <span class="math inline">\(0.01\)</span>.</li>
</ul>
<p>The resulting PRCC scores between T1 and T2 immune subpopulations with the 9 parameters tested for sensitivity are reported in <a href="#tbl-pcor-computation" class="quarto-xref">Table&nbsp;2</a>:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>prcc_sensitivity <span class="ot">&lt;-</span> <span class="fu">pcor</span>(sensitivity_outputs)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>prcc_estimate <span class="ot">&lt;-</span> prcc_sensitivity<span class="sc">$</span>estimate <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mat, <span class="at">rownames =</span> <span class="st">"species"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (species, T1, T2) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join on the same dataset pvalues and PRCC estimations.</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(prcc_sensitivity<span class="sc">$</span>p.value <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>               tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mat, <span class="at">rownames =</span> <span class="st">"species"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span> (species, T1, T2) <span class="sc">|&gt;</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="sc">!</span>species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>)), <span class="at">by =</span> <span class="st">"species"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">".pval"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">T1 =</span> <span class="fu">if_else</span>(T1.pval <span class="sc">&lt;=</span><span class="fl">0.01</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f*"</span>, T1), <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, T1)),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">T2 =</span> <span class="fu">if_else</span>(T2.pval <span class="sc">&lt;=</span><span class="fl">0.01</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f*"</span>, T2), <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, T2))) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>T1.pval, <span class="sc">-</span>T2.pval)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Format PRCC table</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(prcc_estimate) <span class="sc">|&gt;</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_row</span>(<span class="at">values =</span> <span class="st">"* denotes significant PRCC with p-value below 0.01."</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">j =</span> <span class="st">"species"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_equation</span>(<span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{M_{</span><span class="sc">\\</span><span class="st">alpha}}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{M_{10}}"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{12}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{2}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{4}"</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{21}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{6}"</span>, </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">beta}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{10}"</span>)))) <span class="sc">|&gt;</span> </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="st">""</span>, <span class="at">T1 =</span> <span class="st">"PRCC for T1"</span>, <span class="at">T2 =</span> <span class="st">"PRCC for T2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table 5: PRCC values for key parameters playing on T1 and T2 variations."</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-pcor-computation" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure">
<div aria-describedby="tbl-pcor-computation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-258143ba{}.cl-2574c63a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-2579ee44{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-257a2562{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-257a2576{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-257a2580{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-257a2581{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-258143ba"><thead><tr style="overflow-wrap:break-word;"><th class="cl-257a2562"><p class="cl-2579ee44"><span class="cl-2574c63a"></span></p></th><th class="cl-257a2562"><p class="cl-2579ee44"><span class="cl-2574c63a">PRCC for T1</span></p></th><th class="cl-257a2562"><p class="cl-2579ee44"><span class="cl-2574c63a">PRCC for T2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.918*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.364*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.351*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.429*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.967*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.051*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.876*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.024</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.067*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.920*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.007</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.019</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.021</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.007</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2576"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.132*</span></p></td><td class="cl-257a2576"><p class="cl-2579ee44"><span class="cl-2574c63a">0.084*</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-257a2580"><p class="cl-2579ee44">NA</p></td><td class="cl-257a2580"><p class="cl-2579ee44"><span class="cl-2574c63a">-0.062*</span></p></td><td class="cl-257a2580"><p class="cl-2579ee44"><span class="cl-2574c63a">0.087*</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="3" class="cl-257a2581"><p class="cl-2579ee44"><span class="cl-2574c63a">* denotes significant PRCC with p-value below 0.01.</span></p></td></tr></tfoot></table></div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-tbl" id="tbl-pcor-computation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: PRCC values of the 9 parameters benchmarked for <strong>robustness</strong> against steady-state concentrations of <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> immune cell subtypes. Reproduction of Table 5 in <span class="citation" data-cites="lo2016po">Lo et al. (<a href="#ref-lo2016po" role="doc-biblioref">2016</a>)</span>.
</figcaption>
</figure>
</div>
</div>
<div id="imp-prcc" class="callout callout-style-default callout-important callout-titled" title="Pearson Correlation and Partial Correlation">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important&nbsp;1: Pearson Correlation and Partial Correlation
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The standard <strong>Pearson correlation</strong> coefficient between two variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is given by <a href="#eq-pearson-correlation" class="quarto-xref">Equation&nbsp;1</a>:</p>
<p><span id="eq-pearson-correlation"><span class="math display">\[
\rho_{X,Y} = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}
\tag{1}\]</span></span></p>
<p>where:<br>
- <span class="math inline">\(\text{Cov}(X, Y) = \mathbb{E}[(X - \mu_X)(Y - \mu_Y)]\)</span> is the covariance.<br>
- <span class="math inline">\(\sigma_X = \sqrt{\text{Var}(X)}\)</span> and <span class="math inline">\(\sigma_Y = \sqrt{\text{Var}(Y)}\)</span> are the variable standard deviations.</p>
<p>It measures the <strong>linear relationship</strong> between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, but does not control the effect of potential colliders or confounding variables.</p>
<hr>
<p>On the other hand, the <em>Partial Correlation</em> measures the relationship between two variables while <strong>controlling for</strong> the effect of a the remaining set of variables. In a multi-dimensional framework, it’s given by <a href="#eq-partial-correlation" class="quarto-xref">Equation&nbsp;2</a>:</p>
<p><span id="eq-partial-correlation"><span class="math display">\[
\rho_{X,Y \mid \mathbf{Z}} = -\frac{\Omega_{X,Y}}{\sqrt{\Omega_{X,X} \Omega_{Y,Y}}}
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{\Omega} = \mathbf{\Sigma}^{-1}\)</span> is the <strong>precision matrix</strong> (inverse of the covariance matrix).</p>
<hr>
<p>Compared to standard correlations, it removes indirect Relationships triggered by another set of confusing <strong>variables</strong> <span class="math inline">\(\mathbf{Z}\)</span>, thus isolates the <strong>direct</strong> relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and enables more straightforward interpretation by revealing truly causal relationships. For example, in <a href="#fig-prcc-illustration" class="quarto-xref">Figure&nbsp;2</a>, using simply the Pearson correlation, we would have certainly observed a significant correlation between variables <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>. On the other hand, with partial correlation, the spurious connection between <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span> due to the confusing effect of <span class="math inline">\(B\)</span> would certainly has been faded out.</p>
<div class="cell" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode dot code-with-copy"><code class="sourceCode dot"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">digraph</span> <span class="va">G</span> <span class="ot">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">layout</span><span class="ot">=</span><span class="va">neato</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">A</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">B</span><span class="ot">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">B</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">C</span><span class="ot">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ot">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-prcc-illustration" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-prcc-illustration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<svg width="672" height="480" viewbox="0.00 0.00 130.13 169.48" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style="; max-width: none; max-height: none">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 165.48)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-165.48 126.13,-165.48 126.13,4 -4,4"></polygon>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<ellipse fill="none" stroke="black" cx="27" cy="-143.48" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-139.28" font-family="Times,serif" font-size="14.00">A</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<ellipse fill="none" stroke="black" cx="71.02" cy="-86.15" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="71.02" y="-81.95" font-family="Times,serif" font-size="14.00">B</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A-&gt;B</title>
<path fill="none" stroke="black" d="M39.5,-127.2C43.53,-121.96 48.08,-116.02 52.46,-110.33"></path>
<polygon fill="black" stroke="black" points="55.33,-112.33 58.64,-102.27 49.78,-108.07 55.33,-112.33"></polygon>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<ellipse fill="none" stroke="black" cx="95.13" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="95.13" y="-13.8" font-family="Times,serif" font-size="14.00">C</text>
</g>
<!-- B&#45;&gt;C -->
<g id="edge2" class="edge">
<title>B-&gt;C</title>
<path fill="none" stroke="black" d="M77.23,-68.6C79.74,-61.5 82.7,-53.14 85.48,-45.28"></path>
<polygon fill="black" stroke="black" points="88.82,-46.32 88.85,-35.73 82.22,-43.99 88.82,-46.32"></polygon>
</g>
</g>
</svg>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-prcc-illustration-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Simple example of <strong>chain rule</strong> associations.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="plot-rank-transformed-datasets" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="plot-rank-transformed-datasets"><span class="header-section-number">1.4</span> Plot rank-transformed datasets</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs_formatted <span class="ot">&lt;-</span> sensitivity_outputs <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy format: one column storing PRCC values for the x-axis, one for the y-axis, and another for the facets</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>), <span class="at">names_to =</span> <span class="st">"parameters"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>), <span class="at">names_to =</span> <span class="st">"species"</span>, <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provide the same order of facets for direct comparison</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> <span class="fu">factor</span>(parameters, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sigma[b]"</span>, <span class="st">"sigma[10]"</span>, <span class="st">"sigma[12]"</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">species =</span> <span class="fu">factor</span>(species, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"T[1]"</span>,<span class="st">"T[2]"</span>)))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtitles customised for each facet, including the p-value.</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>prcc_values <span class="ot">&lt;-</span> prcc_sensitivity<span class="sc">$</span>estimate</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>prcc_sensitivity_annot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>n_samples<span class="sc">/</span><span class="dv">2</span>, <span class="at">y=</span><span class="cn">Inf</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">lab=</span><span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">"PRCC ="</span>, <span class="fu">c</span>(prcc_values[<span class="st">"T1"</span>, <span class="st">"sb"</span>],</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T1"</span>, <span class="st">"s10"</span>],</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T1"</span>, <span class="st">"s12"</span>],</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"sb"</span>],</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"s10"</span>],</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"s12"</span>]) <span class="sc">|&gt;</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">'%.3f'</span>)), <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">parameters=</span><span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"sigma[b]"</span>, <span class="st">"sigma[10]"</span>, <span class="st">"sigma[12]"</span>), <span class="dv">2</span>), </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">species=</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"T[1]"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"T[2]"</span>, <span class="dv">3</span>)), </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We generate a scatter plot after applying rank-transformation of <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> immune cells subsets, against 3 parameters playing a critical role on the viability of cell pools, namely <span class="math inline">\(\sigma_b\)</span>, <span class="math inline">\(\sigma_{10}\)</span> and <span class="math inline">\(\sigma_{12}\)</span>, the first two controlling the activation rate of Tregs, and the induction of <span class="math inline">\(T_1\)</span> by the global pool of macrophages (including both <span class="math inline">\(M1\)</span> and <span class="math inline">\(M2\)</span> types)<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>SS_plots <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sensitivity_outputs_formatted, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The labeller trick enables to use Latex notations for the subtitles of facets.</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(species <span class="sc">~</span> parameters, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">.rows =</span> label_parsed, <span class="at">.cols =</span> label_parsed)) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(x, y, <span class="at">label=</span>lab),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>prcc_sensitivity_annot, <span class="at">vjust=</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Cell Species"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Free and Variable Parameters"</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Guarantees minimal plot background that would hinder visibility of the output.</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>)) </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>SS_plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sensitivity-plots" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sensitivity-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="prcc_files/figure-html/fig-sensitivity-plots-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sensitivity-plots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Scatter plots of <em>rank-transformed</em> <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> against 3 parameters enumerated in <a href="#tbl-pcor-computation" class="quarto-xref">Table&nbsp;2</a>, exhbiting both strong partial correlation (<span class="math inline">\(|\text{PRCC}|&gt;0.5\)</span> and <span class="math inline">\(p-\)</span>value <span class="math inline">\(&lt;0.01\)</span>). Reproduction of <span class="citation" data-cites="lo2016po">(<a href="#ref-lo2016po" role="doc-biblioref">Lo et al. 2016, 11</a>)</span>, Fig.2.
</figcaption>
</figure>
</div>
</div>
</div>
<p>One of the major advantages of the <code>ggplot2</code> package lies in its seamless ability to save the graphical object in a variety of formats, including <code>pdf</code> and <code>png</code>, as illustrated in <a href="#lst-ggplot-save" class="quarto-xref">Listing&nbsp;2</a>:</p>
<div class="cell" data-layout-align="center">
<div id="lst-ggplot-save" class="r cell-code listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-ggplot-save-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Listing&nbsp;2: Code snippet not run, used for illustration example.
</figcaption>
<div aria-describedby="lst-ggplot-save-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># output is pdf, with a high resolution close to retina visual discrimination ability</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"../../results/Fig2_PRCC.pdf"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> SS_plots, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</figure>
</div>
</div>


<!-- -->


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-lo2016po" class="csl-entry" role="listitem">
Lo, Wing-Cheong, Violeta Arsenescu, Razvan I. Arsenescu, and Avner Friedman. 2016. <span>“Inflammatory <span>Bowel Disease</span>: <span class="nocase">How Effective Is TNF-α Suppression</span>?”</span> <em>PloS One</em> 11 (11): e0165782. <a href="https://doi.org/10.1371/journal.pone.0165782">https://doi.org/10.1371/journal.pone.0165782</a>.
</div>
<div id="ref-rustell" class="csl-entry" role="listitem">
Rustell, Michael. n.d. <span>“Knowledge Extraction and the Development of a Decision Support System for the Conceptual Design of Liquefied Natural Gas Terminals Under Risk and Uncertainty.”</span> University of Surrey. Accessed May 14, 2025. <a href="https://openresearch.surrey.ac.uk/esploro/outputs/doctoral/Knowledge-extraction-and-the-development-of/99511011302346">https://openresearch.surrey.ac.uk/esploro/outputs/doctoral/Knowledge-extraction-and-the-development-of/99511011302346</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Only the uniform sampling, <span class="math inline">\(U_i \sim \mathcal{U}(0,1)\)</span>, is provided with the <code>LHS</code>package. We detailed in <a href="#tip-ITST" class="quarto-xref">Tip&nbsp;2</a> how to simulate any kind of probability distribution from the standard uniform distribution.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note however that both standard random sampling and LHS assume independence between the parameters values, a strong and quite unlikely biological premise.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Note that we assume independence between the parameters, and that the <em>quantile call</em> is performed independenly for each of the dimensions.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>With 8 cores, for instance, 8 computations can be performed in parallel. It might be advised to free completely a CPU to avoid computer freezing<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Another way to visualise the <strong>copy by reference</strong> approach: simply copy the ODE model in another variable <code>healthy_model_copy &lt;- healthy_model</code> in the R canonical way. Compare the storage addresses: <code>lobstr::obj_addr(healthy_model)</code> and <code>lobstr::obj_addr(healthy_model_copy)</code>; you will note that they are identical<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Note that we don’t round the PRCC values, but only format them to display 3 significant digits using the native C <code>sprintf()</code>: difference between both approaches is notably crucial when saving datasets to avoid loss of nuemrical precision<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/bastienchassagnol\.github\.io\/Lo2016_ODE_IBD");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../reproducibility/steady_state.html" class="pagination-link" aria-label="Steady State">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Steady State</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../reproducibility/patient_stratification.html" class="pagination-link" aria-label="Patient Stratification">
        <span class="nav-page-text">Patient Stratification</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb11" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Sensitivity analyses"</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>The list of packages required for reproducing the analyses on this script are listed in @lst-setup-sensitivity-analyses: </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup-prcc}</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-label: lst-setup-sensitivity-analyses</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-cap: Packages required for computing sensitivity analyses. </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github("jpahle/CoRC")</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CoRC)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># tidyverse packages</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># to generate the simulations </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lhs) <span class="co"># Latin Hypercube sampling</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel) <span class="co"># parallel computing</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor) <span class="co"># Compute partial correlations</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Table reporting</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evaluate the sensitivity of immune cells to parameter constants</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generate the distributions of nine critical parameters </span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>We begin to extract the original constants of the 9 parameters assumed to have the strongest impact on the populations of T cell subsets, using <span class="in">`CoRC::getParameters`</span>, reported in @tbl-healthy-parameters:  </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-healthy-parameters</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: The 9 reaction parameters evaluated for **sensitivity analyses**. </span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Retrieve parameters we want to evaluate the versatility ----</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>healthy_model <span class="ot">&lt;-</span> <span class="fu">loadModel</span>(<span class="st">"../../models/team_2016_final_model_lo2016_2025_05_13.cps"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="co"># S2 to be changed</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>parameters_healthy <span class="ot">&lt;-</span> <span class="fu">getParameters</span>(<span class="at">model =</span> healthy_model,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">key =</span> <span class="fu">c</span>(<span class="st">"(Diff of M0 to M1).delta_m_cit"</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Diff of M1 to M2).sigma"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T1 from M).s12"</span>,</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Proliferation of T1).s2"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T2).s4"</span>,</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T17).s21"</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of T17).s6"</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of Tr).sb"</span>,</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"(Induction of Tr).s10"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>mapping)</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(parameters_healthy) <span class="sc">|&gt;</span> </span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_row</span>(<span class="at">values =</span> <span class="st">"key is direct ID of the parameter in the model, reaction describes the biological mechanism associated with the value of the parameter, and value returns the constant value assumed for healthy individuals."</span>, </span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold</span>(<span class="at">part =</span> <span class="st">"header"</span>) </span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>In @lo2016po, they chose to perform **Latin Hypercube Sampling (LHS)** against **Standard Random Sampling**. The differences between these two randomisation approaches are further detailled in @tip-LHS, but briefly, the major advantage of LHS lies in its better coverage of the whole parameter sampling space, especially with a low number of observations (which is usually the case in boostrap simulations due to their high computing cost). </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>::: {#tip-LHS .callout-tip collapse="true" title="Standard versus Latin Hypercube Sampling (LHS)"}</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>Random sampling and Latin Hypercube Sampling differ in how they distribute the sample points within the parameter space:</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>In **Standard Random Sampling**, for a $d-$ random vector, the random samples are drawn independently within each dimension (or variable): </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>x_i^{(j)} \sim p_j(x), \quad j = 1, 2, \dots, d, \quad i = 1, 2, \dots, N</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>where $x_i^{(j)}$ is the $i$-th sample drawn for the $j$-th dimension, $d=9$ (number of parameters evaluated for sensitivity), $N=5000$ the total number of parameter distributions simulated, and $p_j$ the probability distribution^<span class="co">[</span><span class="ot">Only the uniform sampling, $U_i \sim \mathcal{U}(0,1)$, is provided with the `LHS`package. We detailed in @tip-ITST how to simulate any kind of probability distribution from the standard uniform distribution.</span><span class="co">]</span>.</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>Since each sample is drawn completely at random, it's quite likely that some regions might be over-sampled while others may have gaps, with a low number of observations drawn (good coverage of the whole sampling space is only guaranteed asymptotically).</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>--- </span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>In **Latin Hypercube Sampling (LHS)**,  the sampling space is first stratified into $N$ equally probable intervals for each variable $x^{(j)}$; an independent permutation is subsequently applied across dimensions to avoid correlation. Finally, each sample is drawn from of the $N-$ defined intervals.</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>LHS then guarantees a more evenly distributed coverage.</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>To conclude, LHS provides a **better Coverage of the Input Space**(notably reduces the probability of clustering or missing critical regions), **Improved Convergence and Efficiency** by achieving a more accurate representation of the underlying distribution and leading to lower variance in estimated statistics with fewer number of avalaible observations (see @fig-LHS for further illustration). Yet, only standard random sampling is completely independent and unbiased. </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>!<span class="co">[</span><span class="ot">Randomly sampled variables vs. Latin hypercube samples, from [@rustell](https://www.researchgate.net/figure/Randomly-sampled-variables-vs-Latin-hypercube-samples_fig3_322386503). With a low number of observations, the **clustering pattern** inherent to standard random sampling is clearly showcased.</span><span class="co">](../assets/img/Randomly-sampled-variables-vs-Latin-hypercube-samples.png)</span>{#fig-LHS}</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>The code snippet below generates the $N=5000$ bootstrap distribution of the 9 evaluated parameters for robustness, using **Latin Hypercube Sampling**. LHS indeed guarantees better coverage of the *sampling space*.^<span class="co">[</span><span class="ot">Note however that both standard random sampling and LHS assume independence between the parameters values, a strong and quite unlikely biological premise.</span><span class="co">]</span>.</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: lhs-generation</span></span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower and upper bounds are computed within a ±20% range centered around the assumed parameter constant.</span></span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>parameters_sensitivity <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>value</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>param_ranges <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">parameters_name =</span> parameters_healthy<span class="sc">$</span>key, </span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>                               <span class="at">LB=</span> parameters_sensitivity <span class="sc">*</span><span class="fl">0.8</span>,</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>                               <span class="at">UB =</span> parameters_sensitivity <span class="sc">*</span><span class="fl">1.2</span>)</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>) </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>bootstrap_parameters <span class="ot">&lt;-</span> <span class="fu">randomLHS</span>(n_samples, <span class="fu">length</span>(parameters_sensitivity))</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(parameters_sensitivity)) {</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>  bootstrap_parameters[,i] <span class="ot">&lt;-</span> <span class="fu">qunif</span>(bootstrap_parameters[,i], </span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>LB[i],</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>UB[i])</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootstrap_parameters) <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>name</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootstrap_parameters,<span class="dv">2</span>, quantile)</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># &lt;1&gt;</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>parameters_sensitivity <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>value</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>param_ranges <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">parameters_name =</span> parameters_healthy<span class="sc">$</span>key, <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>                               <span class="at">LB=</span> parameters_sensitivity <span class="sc">*</span><span class="fl">0.8</span>,          <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>                               <span class="at">UB =</span> parameters_sensitivity <span class="sc">*</span><span class="fl">1.2</span>)         <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>) <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>bootstrap_parameters <span class="ot">&lt;-</span> <span class="fu">randomLHS</span>(n_samples, <span class="fu">length</span>(parameters_sensitivity)) <span class="co"># &lt;4&gt;</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(parameters_sensitivity)) { <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>  bootstrap_parameters[,i] <span class="ot">&lt;-</span> <span class="fu">qunif</span>(bootstrap_parameters[,i], <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>LB[i],       <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>                                    param_ranges<span class="sc">$</span>UB[i])       <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>}                                                             <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bootstrap_parameters) <span class="ot">&lt;-</span> parameters_healthy<span class="sc">$</span>name</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(bootstrap_parameters,<span class="dv">2</span>, quantile)                       <span class="co"># &lt;6&gt;</span></span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Determine the number of observations, equivalently the number of generated bootstrap distributions (here, $N=5000$).</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Lower and upper bounds are computed within a $\pm 20\%$ range, centered around the parameter constant.</span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>We fix the **random seed** to ensure reproducibibility of the sensitivity analyses.</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>The core function of the <span class="in">`lhs`</span> package, <span class="in">`lhs::randomLHS()`</span>, is only able to perform standard uniform sampling. Two parameters must be provided: the number of observations to derive (here, 5000), and the dimension of the random vector (here, $9$ parameters are considered).</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>How to generate the uniform distribution for a given parameter $X_j \sim \mathcal{U}(0.8 \times X_j^0, 1.2 \times  X_j^0)$, with $X_j^0$ the constant value estimated in a healthy individual, from the standard uniform distribution $U \sim \mathcal{U}(0, 1)$^<span class="co">[</span><span class="ot">Note that we assume independence between the parameters, and that the *quantile call* is performed independenly for each of the dimensions.</span><span class="co">]</span>. By appling the **Inverse Transform Sampling Theorem** (see @tip-ITST), which implies applying the reciprocal of the CDF, in other words, the *quantile function* which is given in R by the <span class="in">`stats::qunif`</span> function. Alternatively, we could have reproduced this result by applying the following affine transformation: <span class="in">`bootstrap_parameters[,i] * (param_ranges$UB[i] -param_ranges$LB[i]) +  param_ranges$LB[i]`</span> on the observations simulated wiht a standard uniform. </span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>By applying the <span class="in">`quantile`</span> function, and since the distribution is supposed evenly distributed on the sampling space, we expect the quantiles to be rather close from their theoretical values (for example, both the median and the mean should be close to the real constant parameter values).</span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>::: {#tip-ITST .callout-tip collapse="true" title="The Inverse Transform Sampling Theorem"}</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>The **Inverse Transform Sampling Theorem** allows generating any probability distribution from the **standard uniform distribution**, $U \sim \mathcal{U}(0,1)$. Let $X$ be a continuous random variable with *cumulative distribution function* (CDF) $F(x)$ and $F^{-1}$ its reciprocal (the quantile function), then:</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>X = F^{-1}(U)</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>follows the same distribution as $X$.</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>In particular, for a uniform distribution $X \sim \mathcal{U}(a, b)$, $a$ and $b$ being respectively the lower and upper bounds, whose CDF is given by: $F(x) = \frac{x - a}{b - a}, \quad a \leq x \leq b$, then the *quantile* function is given by $F^{-1}(u) = a + u(b - a)$. </span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>In other terms, if $U$ follows the standard uniform distirbution, then, by applying the **affine** transformation $X=a + (b - a) U$, $X$ will follow the $X \sim \mathcal{U}(a,b)$ distribution. </span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>Generally speaking, the **Inverse Transform Sampling** allows generating any probability distribution from a uniform $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ applying this formula: $X = F^{-1}(U)$.</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a><span class="in">`bootstrap_parameters`</span> is a 5000 simulations times 9 parameters matrix storing all sampled parameter configurations. We displayed below only the first six lines of the simulated parameter distributions:</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bootstrap-parameters}</span></span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false </span></span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bootstrap_parameters)</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute steady states for the 5000 simulated parameter variations</span></span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>We compute the corresponding steady-states for each of the $N=5000$ simulated parameter configurations. This task is computationally-intensive, but can be easily parallelised, since all bootstrap samples have been generated independently. We use to that end the standard <span class="in">`parallel`</span> package.</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>()) <span class="co"># &lt;1&gt;</span></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cl, <span class="at">varlist =</span> <span class="fu">c</span>(<span class="st">"parameters_healthy"</span>, <span class="st">"bootstrap_parameters"</span>)) <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>cluster_environments <span class="ot">&lt;-</span> <span class="fu">clusterEvalQ</span>(cl, { <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(CoRC) <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr, <span class="at">quietly =</span> <span class="cn">TRUE</span>) <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>  healthy_model <span class="ot">&lt;-</span> <span class="fu">loadModel</span>(<span class="st">"./models/team_2016_final_model_lo2016.cps"</span>) <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>}) <span class="co"># &lt;2&gt;</span></span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs <span class="ot">&lt;-</span> <span class="fu">parLapply</span>(<span class="at">cl =</span> cl, <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X =</span> <span class="dv">1</span><span class="sc">:</span>n_samples, <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>                    <span class="at">f =</span> <span class="cf">function</span> (i) { <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>                      sensitivity_model <span class="ot">&lt;-</span> healthy_model <span class="sc">|&gt;</span> <span class="fu">saveModelToString</span>() <span class="sc">|&gt;</span>  <span class="fu">loadModelFromString</span>()  <span class="co"># &lt;5&gt;</span></span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">setParameters</span>(<span class="at">model =</span> sensitivity_model, <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">key =</span> parameters_healthy<span class="sc">$</span>key, <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">value =</span> bootstrap_parameters[i,])  <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>                      sensitivity_model_steady_state <span class="ot">&lt;-</span> <span class="fu">runSteadyState</span>(  <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>                        <span class="at">model =</span> sensitivity_model <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>                      )<span class="sc">$</span>species <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>                      SS_concentrations <span class="ot">&lt;-</span> <span class="fu">setNames</span>(sensitivity_model_steady_state<span class="sc">$</span>concentration,  <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>                                                    sensitivity_model_steady_state<span class="sc">$</span>name) <span class="sc">|&gt;</span>        <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">as.list</span>() <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span>                                            <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>                        dplyr<span class="sc">::</span><span class="fu">bind_cols</span>(bootstrap_parameters[i, ,<span class="at">drop=</span><span class="cn">FALSE</span>] <span class="sc">|&gt;</span>                   <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">as.data.frame</span>())                                        <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">return</span>(SS_concentrations)                                                    <span class="co"># &lt;3&gt;</span></span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">chunk.size =</span> <span class="dv">50</span>) <span class="sc">|&gt;</span>                                                         <span class="co"># &lt;4&gt;</span></span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">bind_rows</span>()  <span class="co"># &lt;6&gt;</span></span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)  <span class="co"># &lt;7&gt;</span></span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Use <span class="in">`detectCores()`</span> to determine the number of available CPU cores; conditionned to that number (usually 8 or 16 on recent personal laptop configurations); use <span class="in">`makeCluster()`</span> to create the corresponding cluster^<span class="co">[</span><span class="ot">With 8 cores, for instance, 8 computations can be performed in parallel. It might be advised to free completely a CPU to avoid computer freezing</span><span class="co">]</span>.</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Use <span class="in">`clusterExport()`</span> to send current session variables to workers, and <span class="in">`clusterEvalQ()`</span> to load required libraries and/or execute code prior to the parallelised computations. Both functions ensure that the cluster environement has the required modules to start the computation. </span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The Parallel Processing <span class="in">`parLapply()`</span> is the counterpart of the sequential <span class="in">`lapply()`</span> function. The first argument <span class="in">`cl`</span> is the cluster definition. For each parameter configuration among the $N=5000$, we modifify the original ODE model to reflect the LHS parameter configuration, then, compute the modified steady-states associated with that change of parameter configuration. Finally, we return for each parameter configuration a dataset with the modified 15 steady-state concentrations and the corresponding 9 parameter configurations. </span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>The <span class="in">`chunk.size`</span> option controls how data is divided among workers Once computed, another batch of 50 parameter configurations is processed).</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>This line is required, as <span class="in">`CoRC`</span> uses copy by *reference* rather than by *value*. If we had just assigned the loaded healthy ODE model to the modified sensitivity model, `sensitivity_model &lt;- healthy_model`, every modification on `sensitivity_model` would also be reported on `healthy_model`^[Another way to visualise the **copy by reference** approach: simply copy the ODE model in another variable <span class="in">`healthy_model_copy &lt;- healthy_model`</span> in the R canonical way. Compare the storage addresses: <span class="in">`lobstr::obj_addr(healthy_model)`</span> and <span class="in">`lobstr::obj_addr(healthy_model_copy)`</span>; you will note that they are identical].</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>The output of <span class="in">`parLapply`</span> is a list of <span class="in">`data.frame`</span>, function <span class="in">`dplyr::bind_rows()`</span> concatenates them in a single large dataset.</span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Stop the cluster using <span class="in">`stopCluster()`</span> to free computational resources when no longer need.</span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute partial correlation scores</span></span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>To compute the correlations between variations of the constant parameters, and the concentrations of the species at steady state, @lo2016po chose to apply a *rank-transformation* first, which guarantees increased robustness to outliers, and reduces *scaling issues* associated with significant variations of orders of magnitude between the parameters.</span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rank-transformation}</span></span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape and rank-transform sensitivity outputs</span></span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"../../results/sensitivity_outputs.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), rank)) </span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>Then, instead on relying on standard Pearson correlation which may yield spurious relationships between outcomes and parameter variations, @lo2016po computes the **Partial Correlation** score between the rank-transformed variations of species of interest, and the simulated parameter distributions (see @imp-prcc for details). </span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>The <span class="in">`pcor::ppcor`</span> function returns both:</span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`estimate`</span>, the symmetric matrix of the partial correlation coefficient between two variables (included between -1 and 1, the sign providing the type of correlation, and the absolute value the magnitude or strenght of the direct relationship)</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`p.value`</span>, a matrix of the $p-$ values for each of the tests. </span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As in @lo2016po, the threshold for *significance* was set to $0.01$.</span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>The resulting PRCC scores between T1 and T2 immune subpopulations with the 9 parameters tested for sensitivity are reported in @tbl-pcor-computation:</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-pcor-computation</span></span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: PRCC values of the 9 parameters benchmarked for **robustness** against steady-state concentrations of $T_1$ and $T_2$ immune cell subtypes. Reproduction of Table 5 in @lo2016po. </span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>prcc_sensitivity <span class="ot">&lt;-</span> <span class="fu">pcor</span>(sensitivity_outputs)</span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>prcc_estimate <span class="ot">&lt;-</span> prcc_sensitivity<span class="sc">$</span>estimate <span class="sc">|&gt;</span> </span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mat, <span class="at">rownames =</span> <span class="st">"species"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (species, T1, T2) <span class="sc">|&gt;</span> </span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Join on the same dataset pvalues and PRCC estimations.</span></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(prcc_sensitivity<span class="sc">$</span>p.value <span class="sc">|&gt;</span> </span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a>               tibble<span class="sc">::</span><span class="fu">as_tibble</span>(mat, <span class="at">rownames =</span> <span class="st">"species"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>               dplyr<span class="sc">::</span><span class="fu">select</span> (species, T1, T2) <span class="sc">|&gt;</span> </span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(<span class="sc">!</span>species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>)), <span class="at">by =</span> <span class="st">"species"</span>,</span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>             <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">".pval"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">T1 =</span> <span class="fu">if_else</span>(T1.pval <span class="sc">&lt;=</span><span class="fl">0.01</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f*"</span>, T1), <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, T1)),</span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a>         <span class="at">T2 =</span> <span class="fu">if_else</span>(T2.pval <span class="sc">&lt;=</span><span class="fl">0.01</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f*"</span>, T2), <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, T2))) <span class="sc">|&gt;</span> </span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>T1.pval, <span class="sc">-</span>T2.pval)</span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a><span class="do">### Format PRCC table</span></span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(prcc_estimate) <span class="sc">|&gt;</span> </span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_footer_row</span>(<span class="at">values =</span> <span class="st">"* denotes significant PRCC with p-value below 0.01."</span>, </span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colwidths =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">compose</span>(<span class="at">j =</span> <span class="st">"species"</span>,</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>          <span class="at">value =</span> <span class="fu">as_paragraph</span>(<span class="fu">as_equation</span>(<span class="fu">c</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{M_{</span><span class="sc">\\</span><span class="st">alpha}}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{M_{10}}"</span>,</span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{12}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{2}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{4}"</span>,</span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{21}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{6}"</span>, </span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">beta}"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">sigma_{10}"</span>)))) <span class="sc">|&gt;</span> </span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">values =</span> <span class="fu">list</span>(</span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">species =</span> <span class="st">""</span>, <span class="at">T1 =</span> <span class="st">"PRCC for T1"</span>, <span class="at">T2 =</span> <span class="st">"PRCC for T2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">align</span>(<span class="at">align =</span> <span class="st">"center"</span>, <span class="at">part =</span> <span class="st">"all"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_caption</span>(<span class="st">"Table 5: PRCC values for key parameters playing on T1 and T2 variations."</span>) </span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>::: {#imp-prcc .callout-important collapse="true" title="Pearson Correlation and Partial Correlation"}</span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>The standard **Pearson correlation** coefficient between two variables $X$ and $Y$ is given by @eq-pearson-correlation:  </span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a>\rho_{X,Y} = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}</span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>$${#eq-pearson-correlation}</span>
<span id="cb11-284"><a href="#cb11-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-285"><a href="#cb11-285" aria-hidden="true" tabindex="-1"></a>where:  </span>
<span id="cb11-286"><a href="#cb11-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\text{Cov}(X, Y) = \mathbb{E}<span class="co">[</span><span class="ot">(X - \mu_X)(Y - \mu_Y)</span><span class="co">]</span>$ is the covariance.  </span>
<span id="cb11-287"><a href="#cb11-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\sigma_X = \sqrt{\text{Var}(X)}$ and $\sigma_Y = \sqrt{\text{Var}(Y)}$ are the variable standard deviations. </span>
<span id="cb11-288"><a href="#cb11-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-289"><a href="#cb11-289" aria-hidden="true" tabindex="-1"></a>It measures the **linear relationship** between $X$ and $Y$, but does not control the effect of potential colliders or confounding variables.</span>
<span id="cb11-290"><a href="#cb11-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-291"><a href="#cb11-291" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-292"><a href="#cb11-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-293"><a href="#cb11-293" aria-hidden="true" tabindex="-1"></a>On the other hand, the *Partial Correlation* measures the relationship between two variables while **controlling for** the effect of a the remaining set of variables. In a multi-dimensional framework, it's given by @eq-partial-correlation:</span>
<span id="cb11-294"><a href="#cb11-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-295"><a href="#cb11-295" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb11-296"><a href="#cb11-296" aria-hidden="true" tabindex="-1"></a>\rho_{X,Y \mid \mathbf{Z}} = -\frac{\Omega_{X,Y}}{\sqrt{\Omega_{X,X} \Omega_{Y,Y}}}</span>
<span id="cb11-297"><a href="#cb11-297" aria-hidden="true" tabindex="-1"></a>$${#eq-partial-correlation}</span>
<span id="cb11-298"><a href="#cb11-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-299"><a href="#cb11-299" aria-hidden="true" tabindex="-1"></a>where $\mathbf{\Omega} = \mathbf{\Sigma}^{-1}$ is the **precision matrix** (inverse of the covariance matrix).  </span>
<span id="cb11-300"><a href="#cb11-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-301"><a href="#cb11-301" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb11-302"><a href="#cb11-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-303"><a href="#cb11-303" aria-hidden="true" tabindex="-1"></a>Compared to standard correlations, it removes indirect Relationships triggered by another set of confusing **variables** $\mathbf{Z}$, thus isolates the **direct** relationship between $X$ and $Y$, and enables more straightforward interpretation by revealing truly causal relationships. </span>
<span id="cb11-304"><a href="#cb11-304" aria-hidden="true" tabindex="-1"></a>For example, in @fig-prcc-illustration, using simply the Pearson correlation, we would have certainly observed a significant correlation between variables $A$ and $C$. On the other hand, with partial correlation, the spurious connection between $A$ and $C$ due to the confusing effect of $B$ would certainly has been faded out. </span>
<span id="cb11-305"><a href="#cb11-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-308"><a href="#cb11-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{dot}</span></span>
<span id="cb11-309"><a href="#cb11-309" aria-hidden="true" tabindex="-1"></a><span class="co">//| label: fig-prcc-illustration</span></span>
<span id="cb11-310"><a href="#cb11-310" aria-hidden="true" tabindex="-1"></a><span class="co">//| fig-cap: "Simple example of **chain rule** associations."</span></span>
<span id="cb11-311"><a href="#cb11-311" aria-hidden="true" tabindex="-1"></a><span class="kw">digraph</span> <span class="va">G</span> <span class="ot">{</span></span>
<span id="cb11-312"><a href="#cb11-312" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">layout</span><span class="ot">=</span><span class="va">neato</span></span>
<span id="cb11-313"><a href="#cb11-313" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">A</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">B</span><span class="ot">;</span></span>
<span id="cb11-314"><a href="#cb11-314" aria-hidden="true" tabindex="-1"></a><span class="co">    </span><span class="va">B</span><span class="co"> </span><span class="ot">-&gt;</span><span class="co"> </span><span class="va">C</span><span class="ot">;</span></span>
<span id="cb11-315"><a href="#cb11-315" aria-hidden="true" tabindex="-1"></a><span class="ot">}</span></span>
<span id="cb11-316"><a href="#cb11-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-317"><a href="#cb11-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-318"><a href="#cb11-318" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb11-319"><a href="#cb11-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-320"><a href="#cb11-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot rank-transformed datasets</span></span>
<span id="cb11-321"><a href="#cb11-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-322"><a href="#cb11-322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r format-sensitivity-ggplot}</span></span>
<span id="cb11-323"><a href="#cb11-323" aria-hidden="true" tabindex="-1"></a>sensitivity_outputs_formatted <span class="ot">&lt;-</span> sensitivity_outputs <span class="sc">|&gt;</span></span>
<span id="cb11-324"><a href="#cb11-324" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tidy format: one column storing PRCC values for the x-axis, one for the y-axis, and another for the facets</span></span>
<span id="cb11-325"><a href="#cb11-325" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span> (<span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>, <span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-326"><a href="#cb11-326" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>), <span class="at">names_to =</span> <span class="st">"parameters"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-327"><a href="#cb11-327" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>), <span class="at">names_to =</span> <span class="st">"species"</span>, <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-328"><a href="#cb11-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provide the same order of facets for direct comparison</span></span>
<span id="cb11-329"><a href="#cb11-329" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">parameters =</span> <span class="fu">factor</span>(parameters, </span>
<span id="cb11-330"><a href="#cb11-330" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"sb"</span>, <span class="st">"s10"</span>, <span class="st">"s12"</span>),</span>
<span id="cb11-331"><a href="#cb11-331" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"sigma[b]"</span>, <span class="st">"sigma[10]"</span>, <span class="st">"sigma[12]"</span>),</span>
<span id="cb11-332"><a href="#cb11-332" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-333"><a href="#cb11-333" aria-hidden="true" tabindex="-1"></a>                <span class="at">species =</span> <span class="fu">factor</span>(species, </span>
<span id="cb11-334"><a href="#cb11-334" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"T1"</span>, <span class="st">"T2"</span>),</span>
<span id="cb11-335"><a href="#cb11-335" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"T[1]"</span>,<span class="st">"T[2]"</span>)))</span>
<span id="cb11-336"><a href="#cb11-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-337"><a href="#cb11-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Subtitles customised for each facet, including the p-value.</span></span>
<span id="cb11-338"><a href="#cb11-338" aria-hidden="true" tabindex="-1"></a>prcc_values <span class="ot">&lt;-</span> prcc_sensitivity<span class="sc">$</span>estimate</span>
<span id="cb11-339"><a href="#cb11-339" aria-hidden="true" tabindex="-1"></a>prcc_sensitivity_annot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>n_samples<span class="sc">/</span><span class="dv">2</span>, <span class="at">y=</span><span class="cn">Inf</span>, </span>
<span id="cb11-340"><a href="#cb11-340" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">lab=</span><span class="fu">factor</span>(<span class="fu">paste</span>(<span class="st">"PRCC ="</span>, <span class="fu">c</span>(prcc_values[<span class="st">"T1"</span>, <span class="st">"sb"</span>],</span>
<span id="cb11-341"><a href="#cb11-341" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T1"</span>, <span class="st">"s10"</span>],</span>
<span id="cb11-342"><a href="#cb11-342" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T1"</span>, <span class="st">"s12"</span>],</span>
<span id="cb11-343"><a href="#cb11-343" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"sb"</span>],</span>
<span id="cb11-344"><a href="#cb11-344" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"s10"</span>],</span>
<span id="cb11-345"><a href="#cb11-345" aria-hidden="true" tabindex="-1"></a>                                                           prcc_values[<span class="st">"T2"</span>, <span class="st">"s12"</span>]) <span class="sc">|&gt;</span> </span>
<span id="cb11-346"><a href="#cb11-346" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">'%.3f'</span>)), <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb11-347"><a href="#cb11-347" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">parameters=</span><span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"sigma[b]"</span>, <span class="st">"sigma[10]"</span>, <span class="st">"sigma[12]"</span>), <span class="dv">2</span>), </span>
<span id="cb11-348"><a href="#cb11-348" aria-hidden="true" tabindex="-1"></a>                                                       <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-349"><a href="#cb11-349" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">species=</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"T[1]"</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">"T[2]"</span>, <span class="dv">3</span>)), </span>
<span id="cb11-350"><a href="#cb11-350" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb11-351"><a href="#cb11-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-352"><a href="#cb11-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-353"><a href="#cb11-353" aria-hidden="true" tabindex="-1"></a>We generate a scatter plot after applying rank-transformation of $T_1$ and $T_2$ immune cells subsets, against 3 parameters playing a critical role on the viability of cell pools, namely $\sigma_b$, $\sigma_{10}$ and $\sigma_{12}$, the first two controlling the activation rate of Tregs, and the induction of $T_1$ by the global pool of macrophages (including both $M1$ and $M2$ types)^<span class="co">[</span><span class="ot">Note that we don't round the PRCC values, but only format them to display 3 significant digits using the native C `sprintf()`: difference between both approaches is notably crucial when saving datasets to avoid loss of nuemrical precision</span><span class="co">]</span>.</span>
<span id="cb11-354"><a href="#cb11-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-357"><a href="#cb11-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-358"><a href="#cb11-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-sensitivity-plots</span></span>
<span id="cb11-359"><a href="#cb11-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Scatter plots of *rank-transformed* $T_1$ and $T_2$ against 3 parameters enumerated in @tbl-pcor-computation, exhbiting both strong partial correlation ($|\text{PRCC}|&gt;0.5$ and $p-$value $&lt;0.01$). Reproduction of [@lo2016po, pp. 11], Fig.2. </span></span>
<span id="cb11-360"><a href="#cb11-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-361"><a href="#cb11-361" aria-hidden="true" tabindex="-1"></a>SS_plots <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sensitivity_outputs_formatted, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x=</span>x)) <span class="sc">+</span></span>
<span id="cb11-362"><a href="#cb11-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">shape =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb11-363"><a href="#cb11-363" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The labeller trick enables to use Latex notations for the subtitles of facets.</span></span>
<span id="cb11-364"><a href="#cb11-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(species <span class="sc">~</span> parameters, </span>
<span id="cb11-365"><a href="#cb11-365" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">.rows =</span> label_parsed, <span class="at">.cols =</span> label_parsed)) <span class="sc">+</span></span>
<span id="cb11-366"><a href="#cb11-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(x, y, <span class="at">label=</span>lab),</span>
<span id="cb11-367"><a href="#cb11-367" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>prcc_sensitivity_annot, <span class="at">vjust=</span><span class="fl">0.8</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb11-368"><a href="#cb11-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Cell Species"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Free and Variable Parameters"</span>) <span class="sc">+</span></span>
<span id="cb11-369"><a href="#cb11-369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Guarantees minimal plot background that would hinder visibility of the output.</span></span>
<span id="cb11-370"><a href="#cb11-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-371"><a href="#cb11-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb11-372"><a href="#cb11-372" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-373"><a href="#cb11-373" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>)) </span>
<span id="cb11-374"><a href="#cb11-374" aria-hidden="true" tabindex="-1"></a>SS_plots</span>
<span id="cb11-375"><a href="#cb11-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb11-376"><a href="#cb11-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-377"><a href="#cb11-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-378"><a href="#cb11-378" aria-hidden="true" tabindex="-1"></a>One of the major advantages of the <span class="in">`ggplot2`</span> package lies in its seamless ability to save the graphical object in a variety of formats, including <span class="in">`pdf`</span> and <span class="in">`png`</span>, as illustrated in @lst-ggplot-save: </span>
<span id="cb11-379"><a href="#cb11-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-380"><a href="#cb11-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ggplot2-illustration}</span></span>
<span id="cb11-381"><a href="#cb11-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-label: lst-ggplot-save</span></span>
<span id="cb11-382"><a href="#cb11-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| lst-cap: Code snippet not run, used for illustration example. </span></span>
<span id="cb11-383"><a href="#cb11-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb11-384"><a href="#cb11-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-385"><a href="#cb11-385" aria-hidden="true" tabindex="-1"></a><span class="co"># output is pdf, with a high resolution close to retina visual discrimination ability</span></span>
<span id="cb11-386"><a href="#cb11-386" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"../../results/Fig2_PRCC.pdf"</span>, </span>
<span id="cb11-387"><a href="#cb11-387" aria-hidden="true" tabindex="-1"></a>       <span class="at">plot =</span> SS_plots, <span class="at">dpi =</span> <span class="dv">600</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">10</span>,</span>
<span id="cb11-388"><a href="#cb11-388" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb11-389"><a href="#cb11-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org"><iconify-icon role="img" inline="" icon="simple-icons:quarto" aria-label="Icon quarto from simple-icons Iconify.design set." title="Icon quarto from simple-icons Iconify.design set."></iconify-icon> Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
<p>© <span id="current-year"></span> Bastien CHASSAGNOL.</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/edit/master/reproducibility/prcc.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/blob/master/reproducibility/prcc.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://github.com/bastienchassagnol//COPASI_Team216_Lo2016/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>License: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY NC SA 4.0</a>.</p>
</div>
  </div>
</footer>




</body></html>